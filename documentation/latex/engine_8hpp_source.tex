\hypertarget{engine_8hpp_source}{}\doxysection{engine.\+hpp}
\label{engine_8hpp_source}\index{src/engine.hpp@{src/engine.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef ENGINE}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define ENGINE}}
\DoxyCodeLine{3 \textcolor{comment}{/* Game will be built like a linked list and a graph(tree). */}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <map>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}tinyxml2.h"{}}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{keyword}{class }\mbox{\hyperlink{classWorld}{World}};}
\DoxyCodeLine{12 \textcolor{keyword}{class }\mbox{\hyperlink{classObject}{Object}};}
\DoxyCodeLine{13 \textcolor{keyword}{class }\mbox{\hyperlink{classRoom}{Room}};}
\DoxyCodeLine{14 \textcolor{keyword}{class }\mbox{\hyperlink{classEntity}{Entity}};}
\DoxyCodeLine{15 \textcolor{keyword}{class }\mbox{\hyperlink{classMission}{Mission}};}
\DoxyCodeLine{16 \textcolor{keyword}{class }Choice;}
\DoxyCodeLine{17 }
\DoxyCodeLine{22 \textcolor{keyword}{typedef} std::shared\_ptr<Room> node;}
\DoxyCodeLine{27 \textcolor{keyword}{typedef} std::unique\_ptr<Object> item;}
\DoxyCodeLine{32 \textcolor{keyword}{typedef} std::shared\_ptr<Entity> ent;}
\DoxyCodeLine{37 \textcolor{keyword}{typedef} std::vector<node> nodes;}
\DoxyCodeLine{42 \textcolor{keyword}{typedef} std::vector<item> items;}
\DoxyCodeLine{47 \textcolor{keyword}{typedef} std::vector<ent> entities;}
\DoxyCodeLine{52 \textcolor{keyword}{typedef} std::pair<int, std::vector<int>> roomConnection;}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{keyword}{enum} missionStatus\{finished, in\_progress\};}
\DoxyCodeLine{55 }
\DoxyCodeLine{61 \textcolor{keyword}{class }\mbox{\hyperlink{classMission}{Mission}} \{}
\DoxyCodeLine{62     std::string description;}
\DoxyCodeLine{63     node targetRoom;}
\DoxyCodeLine{64     item targetItem;}
\DoxyCodeLine{65     missionStatus status;}
\DoxyCodeLine{66 \textcolor{keyword}{public}:}
\DoxyCodeLine{67     \mbox{\hyperlink{classMission}{Mission}}(node tr) : targetRoom(tr), status(in\_progress) \{\}}
\DoxyCodeLine{68     \mbox{\hyperlink{classMission}{Mission}}(item ti) : targetItem(std::move(ti)), status(in\_progress) \{\}}
\DoxyCodeLine{69     \mbox{\hyperlink{classMission}{Mission}}(node tr, item ti) : targetRoom(tr), targetItem(std::move(ti)), status(in\_progress) \{\}}
\DoxyCodeLine{70     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} complete() \{\}  }
\DoxyCodeLine{71 \};}
\DoxyCodeLine{72 }
\DoxyCodeLine{77 \textcolor{keyword}{class }\mbox{\hyperlink{classObject}{Object}} \{}
\DoxyCodeLine{78     \textcolor{keyword}{const} std::string objectName;}
\DoxyCodeLine{79     \textcolor{keyword}{const} std::string objectDescriptor;}
\DoxyCodeLine{80     \textcolor{keyword}{const} \textcolor{keywordtype}{int} objID;}
\DoxyCodeLine{81     }
\DoxyCodeLine{82 \textcolor{keyword}{public}:}
\DoxyCodeLine{90     \mbox{\hyperlink{classObject_a093caad8e34a80b953f16f10724b39aa}{Object}}(\textcolor{keyword}{const} std::string\& n, \textcolor{keyword}{const} \textcolor{keywordtype}{int} \textcolor{keywordtype}{id}, \textcolor{keyword}{const} std::string\& d) : objectName(n), objectDescriptor(d), objID(id)  \{\}}
\DoxyCodeLine{96     std::string \mbox{\hyperlink{classObject_acb9b466607cb80beaaa30ece2f7f570a}{getName}}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} objectName;\}}
\DoxyCodeLine{102     \textcolor{keywordtype}{int} \textcolor{keyword}{const} \mbox{\hyperlink{classObject_aaad299b2f249c9d89a419b5c1ac22e85}{getID}}() \{\textcolor{keywordflow}{return} objID;\}}
\DoxyCodeLine{108     std::string \mbox{\hyperlink{classObject_a3f44136a9cb5eda00144695c1a0b1a2c}{getDescription}}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} objectDescriptor;\}}
\DoxyCodeLine{109     \textcolor{keyword}{virtual} \mbox{\hyperlink{classObject}{\string~Object}}() \{\}}
\DoxyCodeLine{110 \};}
\DoxyCodeLine{111 }
\DoxyCodeLine{116 \textcolor{keyword}{class }\mbox{\hyperlink{classKey}{Key}} : \textcolor{keyword}{public} \mbox{\hyperlink{classObject}{Object}} \{}
\DoxyCodeLine{117     \textcolor{keyword}{const} \textcolor{keywordtype}{int} keyID;}
\DoxyCodeLine{118 \textcolor{keyword}{public}:}
\DoxyCodeLine{119     \mbox{\hyperlink{classKey}{Key}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} kid, \textcolor{keyword}{const} std::string\& n, \textcolor{keyword}{const} \textcolor{keywordtype}{int} \textcolor{keywordtype}{id}, \textcolor{keyword}{const} std::string\& d) : \mbox{\hyperlink{classObject}{Object}}(n, \textcolor{keywordtype}{id}, d), keyID(kid) \{\}}
\DoxyCodeLine{120 \};}
\DoxyCodeLine{121 }
\DoxyCodeLine{126 \textcolor{keyword}{class }\mbox{\hyperlink{classEntity}{Entity}} \{}
\DoxyCodeLine{127     \textcolor{keyword}{const} std::string name;}
\DoxyCodeLine{128     items inventory;}
\DoxyCodeLine{129     \textcolor{keywordtype}{int} hp;}
\DoxyCodeLine{130     \textcolor{keywordtype}{int} stamina;}
\DoxyCodeLine{131     \textcolor{keywordtype}{int} intelligence;}
\DoxyCodeLine{132     \textcolor{keywordtype}{int} agility;}
\DoxyCodeLine{133     \textcolor{keywordtype}{int} strenght;}
\DoxyCodeLine{134     \textcolor{keywordtype}{int} stealth;}
\DoxyCodeLine{135     \textcolor{keywordtype}{int} carisma;}
\DoxyCodeLine{136 \textcolor{keyword}{public}:}
\DoxyCodeLine{142     \mbox{\hyperlink{classEntity_afeaa874d724166b9ad1c240cbd1127ea}{Entity}}(\textcolor{keyword}{const} std::string\& n) : name(n) \{\}}
\DoxyCodeLine{148     std::string \mbox{\hyperlink{classEntity_a403f69eb888da7c5a690b79c658cdf47}{getName}}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} name;\}}
\DoxyCodeLine{155     \mbox{\hyperlink{classEntity}{Entity}}\& \mbox{\hyperlink{classEntity_a0a4f093c549569becf5e0e42b8a1ceb2}{addItem}}(item \&i) \{}
\DoxyCodeLine{156         inventory.push\_back(std::move(i));}
\DoxyCodeLine{157         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{158     \}}
\DoxyCodeLine{165     \mbox{\hyperlink{classEntity}{Entity}}\& \mbox{\hyperlink{classEntity_a9b0ef78013c984bc8cd8944332a14058}{addItems}}(items \&i) \{}
\DoxyCodeLine{166         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} it = i.begin(); it != i.end(); it++) \{}
\DoxyCodeLine{167             this-\/>\mbox{\hyperlink{classEntity_a0a4f093c549569becf5e0e42b8a1ceb2}{addItem}}(*it);}
\DoxyCodeLine{168         \}}
\DoxyCodeLine{169         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{170     \}}
\DoxyCodeLine{176     items\& \mbox{\hyperlink{classEntity_a38aad2959e7cbeaf15aa0dbf71df66c5}{getInventory}}() \{}
\DoxyCodeLine{177         \textcolor{keywordflow}{return} inventory;}
\DoxyCodeLine{178     \}}
\DoxyCodeLine{179     \mbox{\hyperlink{classEntity}{\string~Entity}}() \{}
\DoxyCodeLine{180         \textcolor{keywordflow}{for} (items::iterator it = inventory.begin(); it != inventory.end(); it++) \{}
\DoxyCodeLine{181             it-\/>reset();}
\DoxyCodeLine{182         \}}
\DoxyCodeLine{183     \}}
\DoxyCodeLine{184 \};}
\DoxyCodeLine{185 }
\DoxyCodeLine{190 \textcolor{keyword}{enum} LockStatus\{locked, unlocked\};}
\DoxyCodeLine{191 }
\DoxyCodeLine{197 \textcolor{keyword}{class }\mbox{\hyperlink{classRoom}{Room}} \{}
\DoxyCodeLine{198     \textcolor{keyword}{const} std::string roomName; \textcolor{comment}{// Name of the room.}}
\DoxyCodeLine{199     \textcolor{keyword}{const} \textcolor{keywordtype}{int} roomID; \textcolor{comment}{// ID of the room, that connects a key to this room.}}
\DoxyCodeLine{200     \textcolor{keyword}{const} std::string description; \textcolor{comment}{// Description of the room.}}
\DoxyCodeLine{201     LockStatus lock;}
\DoxyCodeLine{202     entities roomPopulation;}
\DoxyCodeLine{203     nodes neighbours; \textcolor{comment}{// Neighbouring rooms.}}
\DoxyCodeLine{204     items inventory; \textcolor{comment}{// Items, that can be found in the room.}}
\DoxyCodeLine{205 \textcolor{keyword}{public}:}
\DoxyCodeLine{213     \mbox{\hyperlink{classRoom_a6444c5cbd53d2120b05a75850ea404cf}{Room}}(\textcolor{keyword}{const} std::string\& n, \textcolor{keywordtype}{int} \textcolor{keywordtype}{id}, \textcolor{keyword}{const} std::string\& desc) : roomName(n), roomID(id), description(desc), lock(locked) \{\}}
\DoxyCodeLine{219     std::string \mbox{\hyperlink{classRoom_a767de198f529425dd4ba81810e44d6e4}{getName}}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} roomName;\}}
\DoxyCodeLine{225     \textcolor{keywordtype}{int} \mbox{\hyperlink{classRoom_aa6f8e73b0570d7cc208189ebf79b9042}{getID}}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} roomID;\}}
\DoxyCodeLine{231     std::string \mbox{\hyperlink{classRoom_a33c1c0ac8a2e43da7b59522175811d63}{getDescription}}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} description;\}}
\DoxyCodeLine{237     nodes \mbox{\hyperlink{classRoom_a95bd4e1f1a2d7971cd6917f1eae145e8}{getNeighbours}}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} neighbours;\}   }
\DoxyCodeLine{244     \mbox{\hyperlink{classRoom}{Room}}\& \mbox{\hyperlink{classRoom_a3e2b4acf74611dab017b41303a9e65a0}{addNeighbour}}(node\& nn) \{}
\DoxyCodeLine{245         neighbours.push\_back(nn);}
\DoxyCodeLine{246         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{247     \}}
\DoxyCodeLine{254     \mbox{\hyperlink{classRoom}{Room}}\& \mbox{\hyperlink{classRoom_adbf499e9a38b3a8d48d2f3bd11ebaa0f}{addNeighbours}}(nodes\& ns) \{}
\DoxyCodeLine{255         \textcolor{keywordflow}{for} (nodes::const\_iterator it = ns.cbegin(); it != ns.cend(); it++) \{}
\DoxyCodeLine{256             neighbours.push\_back(node(*it));}
\DoxyCodeLine{257         \}}
\DoxyCodeLine{258         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{259     \}}
\DoxyCodeLine{265     items\& \mbox{\hyperlink{classRoom_a40bed777c79ab2b9a3d0f8bf28eb008d}{getItems}}() \{\textcolor{keywordflow}{return} inventory;\}   }
\DoxyCodeLine{272     \mbox{\hyperlink{classRoom}{Room}}\& \mbox{\hyperlink{classRoom_a2a53e91b4f576003f4aa357dfc9a1d70}{addItem}}(item\& i) \{}
\DoxyCodeLine{273         inventory.emplace\_back(std::move(i));}
\DoxyCodeLine{274         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{275     \}}
\DoxyCodeLine{282     \mbox{\hyperlink{classRoom}{Room}}\& \mbox{\hyperlink{classRoom_a93d03e0d911cb12e6eaa1e05eddda1b1}{addItems}}(items\& inv) \{}
\DoxyCodeLine{283         \textcolor{keywordflow}{for} (items::iterator it = inv.begin(); it != inv.end(); it++) \{}
\DoxyCodeLine{284             this-\/>\mbox{\hyperlink{classRoom_a2a53e91b4f576003f4aa357dfc9a1d70}{addItem}}(*it);}
\DoxyCodeLine{285         \}}
\DoxyCodeLine{286         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{287     \}}
\DoxyCodeLine{294     \mbox{\hyperlink{classRoom}{Room}}\& \mbox{\hyperlink{classRoom_afa0bebd4b898687e8c9cd6ed2b7e5d67}{addEntity}}(ent\& e) \{}
\DoxyCodeLine{295         roomPopulation.push\_back(e);}
\DoxyCodeLine{296         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{297     \}}
\DoxyCodeLine{304     \mbox{\hyperlink{classRoom}{Room}}\& \mbox{\hyperlink{classRoom_a472a6e27ca1547c9051f1b89692ed0ca}{addEntities}}(entities\& ents) \{}
\DoxyCodeLine{305         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} e : ents) \{}
\DoxyCodeLine{306             this-\/>\mbox{\hyperlink{classRoom_afa0bebd4b898687e8c9cd6ed2b7e5d67}{addEntity}}(e);}
\DoxyCodeLine{307         \}}
\DoxyCodeLine{308         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{309     \}}
\DoxyCodeLine{316     \mbox{\hyperlink{classRoom}{Room}}\& \mbox{\hyperlink{classRoom_a3e1b856c3f6c5f562796e857fe4777ac}{setLock}}(LockStatus stat) \{}
\DoxyCodeLine{317         lock = stat;}
\DoxyCodeLine{318         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{319     \}}
\DoxyCodeLine{328     \textcolor{keywordtype}{bool} \textcolor{keyword}{static} \mbox{\hyperlink{classRoom_acba04eb3643e5204dbcabbc099591c8a}{unlock}}(item\& k, node r) \{}
\DoxyCodeLine{329         \mbox{\hyperlink{classKey}{Key}}* k2r = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classKey}{Key}}*\textcolor{keyword}{>}(k.release());}
\DoxyCodeLine{330         \textcolor{keywordflow}{if} (k2r != \textcolor{keyword}{nullptr} \&\& k-\/>\mbox{\hyperlink{classObject_aaad299b2f249c9d89a419b5c1ac22e85}{getID}}() == r-\/>getID()) \{}
\DoxyCodeLine{331             r-\/>setLock(unlocked);}
\DoxyCodeLine{332             \textcolor{keyword}{delete} k2r;}
\DoxyCodeLine{333             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{334         \}}
\DoxyCodeLine{335         \mbox{\hyperlink{classObject}{Object}}* o = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classObject}{Object}}*\textcolor{keyword}{>}(k2r);}
\DoxyCodeLine{336         k = std::make\_unique<Object>(*o);}
\DoxyCodeLine{337         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{338     \}}
\DoxyCodeLine{344     \mbox{\hyperlink{classRoom_a67d5da09983cc53097807fd43ba5481a}{\string~Room}}() \{}
\DoxyCodeLine{345         \textcolor{keywordflow}{for} (nodes::iterator nit = neighbours.begin(); nit != neighbours.end(); nit++) \{}
\DoxyCodeLine{346             nit-\/>reset();}
\DoxyCodeLine{347         \}}
\DoxyCodeLine{348         \textcolor{keywordflow}{for} (items::iterator iit = inventory.begin(); iit != inventory.end(); iit++) \{}
\DoxyCodeLine{349             iit-\/>reset();}
\DoxyCodeLine{350         \}}
\DoxyCodeLine{351     \}}
\DoxyCodeLine{352 \};}
\DoxyCodeLine{353 }
\DoxyCodeLine{359 \textcolor{keyword}{class }\mbox{\hyperlink{classWorld}{World}} \{}
\DoxyCodeLine{360     std::string title;}
\DoxyCodeLine{361     nodes worldRooms;}
\DoxyCodeLine{362     entities population;}
\DoxyCodeLine{363     \mbox{\hyperlink{classtinyxml2_1_1XMLDocument}{tinyxml2::XMLDocument}} story;}
\DoxyCodeLine{364     std::map<int, std::vector<int>> roomConnectionMap;}
\DoxyCodeLine{365 \textcolor{keyword}{public}:}
\DoxyCodeLine{370     \mbox{\hyperlink{classWorld_afa39d4e6f714a7a3691ac0c656f5e8a8}{World}}() \{\}}
\DoxyCodeLine{376     \mbox{\hyperlink{classWorld_a99df53285c45b4045aae7b13ecfc023e}{World}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* path2story) \{}
\DoxyCodeLine{377         story.\mbox{\hyperlink{classtinyxml2_1_1XMLDocument_a2ebd4647a8af5fc6831b294ac26a150a}{LoadFile}}(path2story);}
\DoxyCodeLine{378     \}}
\DoxyCodeLine{384     nodes \mbox{\hyperlink{classWorld_a08cf2edbbd0a3b40eb7bf88e99a00b42}{getWorldRooms}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{385         \textcolor{keywordflow}{return} worldRooms;}
\DoxyCodeLine{386     \}}
\DoxyCodeLine{392     entities \mbox{\hyperlink{classWorld_a2a88c008b655a0e9e24cc0e7bb097e86}{getPopulation}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{393         \textcolor{keywordflow}{return} population;}
\DoxyCodeLine{394     \}}
\DoxyCodeLine{402     \textcolor{keywordtype}{void} \mbox{\hyperlink{classWorld_a34bad91d52943ee1487577c3fc394a48}{RoomFactory}}(\textcolor{keyword}{const} std::string\& name, \textcolor{keywordtype}{int} \textcolor{keywordtype}{id}, \textcolor{keyword}{const} std::string\& desc) \{}
\DoxyCodeLine{403         \textcolor{keyword}{auto} newRoom = std::make\_shared<Room>(name, \textcolor{keywordtype}{id}, desc);}
\DoxyCodeLine{404         worldRooms.emplace\_back(newRoom);}
\DoxyCodeLine{405         newRoom.reset();}
\DoxyCodeLine{406     \}}
\DoxyCodeLine{412     \textcolor{keywordtype}{void} \mbox{\hyperlink{classWorld_aad0469c77c910ef667f870f2815bd08d}{EntityFactory}}(\textcolor{keyword}{const} std::string\& name) \{}
\DoxyCodeLine{413         \textcolor{keyword}{auto} newEnt = std::make\_shared<Entity>(name);}
\DoxyCodeLine{414         population.emplace\_back(newEnt);}
\DoxyCodeLine{415         newEnt.reset();}
\DoxyCodeLine{416     \}}
\DoxyCodeLine{422     \mbox{\hyperlink{classtinyxml2_1_1XMLDocument}{tinyxml2::XMLDocument}}\& \mbox{\hyperlink{classWorld_a9bde3dadff7330368dfa23472b413e15}{getStory}}() \{\textcolor{keywordflow}{return} story;\}}
\DoxyCodeLine{429     items \mbox{\hyperlink{classWorld_ac9a7d7ff24cdf209e3cde1fa623cee0d}{makeInventory}}(\mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* invEle) \{}
\DoxyCodeLine{430         \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* firstObj = invEle-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}object"{}});}
\DoxyCodeLine{431         \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* actual = firstObj;}
\DoxyCodeLine{432         items retItems;}
\DoxyCodeLine{433         \textcolor{keywordflow}{while}(actual) \{}
\DoxyCodeLine{434             \textcolor{keyword}{const} std::string objName(actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}name"{}})-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a0fa5bea0a4daf3ddd503dcabb823eba6}{GetText}}());}
\DoxyCodeLine{435             \textcolor{keyword}{const} std::string desc(actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}description"{}})-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a0fa5bea0a4daf3ddd503dcabb823eba6}{GetText}}());}
\DoxyCodeLine{436             \textcolor{keywordtype}{int} \textcolor{keywordtype}{id} = 0;}
\DoxyCodeLine{437             actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}id"{}})-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a926357996bef633cb736e1a558419632}{QueryIntText}}(\&\textcolor{keywordtype}{id});}
\DoxyCodeLine{438             \textcolor{keyword}{auto} newObj = std::make\_unique<Object>(objName, \textcolor{keywordtype}{id}, desc);}
\DoxyCodeLine{439             retItems.push\_back(std::move(newObj));}
\DoxyCodeLine{440             actual = actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a14ea560df31110ff07a9f566171bf797}{NextSiblingElement}}(\textcolor{stringliteral}{"{}object"{}});}
\DoxyCodeLine{441         \}}
\DoxyCodeLine{442         \textcolor{keywordflow}{return} retItems;}
\DoxyCodeLine{443     \}}
\DoxyCodeLine{450     std::vector<int> \mbox{\hyperlink{classWorld_a8506babc337a9ef2c7dfb48d2dda9fa0}{trackConnections}}(\mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* conns) \{}
\DoxyCodeLine{451         \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* firstConn = conns-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}id"{}});}
\DoxyCodeLine{452         \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* actual = firstConn;}
\DoxyCodeLine{453         std::vector<int> neighbours;}
\DoxyCodeLine{454         \textcolor{keywordflow}{while}(actual) \{}
\DoxyCodeLine{455             \textcolor{keywordtype}{int} nid = 0;}
\DoxyCodeLine{456             actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a926357996bef633cb736e1a558419632}{QueryIntText}}(\&nid);}
\DoxyCodeLine{457             neighbours.push\_back(nid); }
\DoxyCodeLine{458             actual = actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a14ea560df31110ff07a9f566171bf797}{NextSiblingElement}}(\textcolor{stringliteral}{"{}id"{}});}
\DoxyCodeLine{459         \}}
\DoxyCodeLine{460         \textcolor{keywordflow}{return} neighbours;}
\DoxyCodeLine{461     \}}
\DoxyCodeLine{467     \textcolor{keywordtype}{void} \mbox{\hyperlink{classWorld_a7165c451a927399e060fa07a2e6b69d3}{loadRooms}}(\mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* firstRoom) \{}
\DoxyCodeLine{468         \textcolor{keyword}{const} \textcolor{keywordtype}{char}* elementName = \textcolor{stringliteral}{"{}room"{}};}
\DoxyCodeLine{469         \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* actual = firstRoom;}
\DoxyCodeLine{470         \textcolor{keywordflow}{while}(actual) \{}
\DoxyCodeLine{471             \textcolor{keyword}{const} std::string roomName(actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}name"{}})-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a0fa5bea0a4daf3ddd503dcabb823eba6}{GetText}}());}
\DoxyCodeLine{472             \textcolor{keyword}{const} std::string roomDescription(actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}description"{}})-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a0fa5bea0a4daf3ddd503dcabb823eba6}{GetText}}());}
\DoxyCodeLine{473             \textcolor{keywordtype}{int} roomID = 0;}
\DoxyCodeLine{474             actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}id"{}})-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a926357996bef633cb736e1a558419632}{QueryIntText}}(\&roomID);}
\DoxyCodeLine{475             \mbox{\hyperlink{classWorld_a34bad91d52943ee1487577c3fc394a48}{RoomFactory}}(roomName, roomID, roomDescription); \textcolor{comment}{// Construct room with name, id and desc}}
\DoxyCodeLine{476             \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* invEle = actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}inventory"{}});}
\DoxyCodeLine{477             \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* actualInv = invEle-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}object"{}});}
\DoxyCodeLine{478             \textcolor{keywordflow}{while}(actualInv) \{}
\DoxyCodeLine{479                 \textcolor{keyword}{const} std::string objName(actualInv-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}name"{}})-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a0fa5bea0a4daf3ddd503dcabb823eba6}{GetText}}());}
\DoxyCodeLine{480                 \textcolor{keyword}{const} std::string desc(actualInv-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}description"{}})-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a0fa5bea0a4daf3ddd503dcabb823eba6}{GetText}}());}
\DoxyCodeLine{481                 \textcolor{keywordtype}{int} objectID = 0;}
\DoxyCodeLine{482                 actualInv-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}id"{}})-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a926357996bef633cb736e1a558419632}{QueryIntText}}(\&objectID);}
\DoxyCodeLine{483                 \textcolor{keyword}{auto} tmpItem = std::make\_unique<Object>(objName, objectID, desc);}
\DoxyCodeLine{484                 worldRooms.back()-\/>addItem(tmpItem);}
\DoxyCodeLine{485                 actualInv = actualInv-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a14ea560df31110ff07a9f566171bf797}{NextSiblingElement}}(\textcolor{stringliteral}{"{}object"{}});}
\DoxyCodeLine{486             \}}
\DoxyCodeLine{487             \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* conns = actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}connections"{}});}
\DoxyCodeLine{488             roomConnectionMap.insert(std::make\_pair(roomID, \mbox{\hyperlink{classWorld_a8506babc337a9ef2c7dfb48d2dda9fa0}{trackConnections}}(conns)));}
\DoxyCodeLine{489             \textcolor{comment}{// While loading entities into population, the number of entities loaded must be returned to be able to add these enitites to the room they should be in.}}
\DoxyCodeLine{490             \textcolor{keywordtype}{int} entCount = \mbox{\hyperlink{classWorld_a72e5443eaf011a10fcc9352ffa844bd8}{loadEntities}}(actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}entity"{}}));}
\DoxyCodeLine{491             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = \textcolor{keywordtype}{int}(population.size())-\/entCount; i < \textcolor{keywordtype}{int}(population.size()); i++) \{}
\DoxyCodeLine{492                 worldRooms.back()-\/>addEntity(population[i]);}
\DoxyCodeLine{493             \}}
\DoxyCodeLine{494             actual = actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a14ea560df31110ff07a9f566171bf797}{NextSiblingElement}}(elementName);}
\DoxyCodeLine{495         \}}
\DoxyCodeLine{496     \}}
\DoxyCodeLine{501     \textcolor{keywordtype}{void} \mbox{\hyperlink{classWorld_aebe04bd680604ecfdf2acbe61b828584}{connectRooms}}() \{}
\DoxyCodeLine{502         \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{int}, std::vector<int>>::iterator it = roomConnectionMap.begin(); it != roomConnectionMap.end(); it++) \{}
\DoxyCodeLine{503             \textcolor{keywordtype}{int} parentID = it-\/>first;   }
\DoxyCodeLine{504             nodes::iterator parentRoom = std::find\_if(worldRooms.begin(), worldRooms.end(), }
\DoxyCodeLine{505                     [\&parentID](node\& r) \{if (r-\/>getID() == parentID) return true; return false;\});}
\DoxyCodeLine{506             \textcolor{keywordflow}{if} (parentRoom != worldRooms.end()) \{}
\DoxyCodeLine{507                 \textcolor{keywordflow}{for} (std::vector<int>::iterator sit = it-\/>second.begin(); sit != it-\/>second.end(); sit++) \{}
\DoxyCodeLine{508                     \textcolor{keywordtype}{int} id2find = *sit;}
\DoxyCodeLine{509                     nodes::iterator childRoom = std::find\_if(worldRooms.begin(), worldRooms.end(), }
\DoxyCodeLine{510                         [\&id2find](node\& r) \{if (r-\/>getID() == id2find) return true; return false;\});}
\DoxyCodeLine{511                     \textcolor{keywordflow}{if} (childRoom != worldRooms.end()) \{}
\DoxyCodeLine{512                         parentRoom-\/>get()-\/>addNeighbour(*childRoom);}
\DoxyCodeLine{513                     \}}
\DoxyCodeLine{514                 \}   }
\DoxyCodeLine{515             \}}
\DoxyCodeLine{516         \}}
\DoxyCodeLine{517     \}}
\DoxyCodeLine{523     \textcolor{keywordtype}{int} \mbox{\hyperlink{classWorld_a72e5443eaf011a10fcc9352ffa844bd8}{loadEntities}}(\mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* firstEle) \{}
\DoxyCodeLine{524         \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* actual = firstEle;}
\DoxyCodeLine{525         \textcolor{keywordtype}{int} counter = 0;}
\DoxyCodeLine{526         \textcolor{keywordflow}{while}(actual) \{}
\DoxyCodeLine{527             \textcolor{keyword}{const} std::string name = actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}name"{}})-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLElement_a0fa5bea0a4daf3ddd503dcabb823eba6}{GetText}}();}
\DoxyCodeLine{528             \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* invele = actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}inventory"{}});}
\DoxyCodeLine{529             items inv = \mbox{\hyperlink{classWorld_ac9a7d7ff24cdf209e3cde1fa623cee0d}{makeInventory}}(invele);}
\DoxyCodeLine{530             ent newEnt = std::make\_shared<Entity>(name);}
\DoxyCodeLine{531             population.push\_back(newEnt);}
\DoxyCodeLine{532             population.back()-\/>addItems(inv);}
\DoxyCodeLine{533             actual = actual-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a14ea560df31110ff07a9f566171bf797}{NextSiblingElement}}(\textcolor{stringliteral}{"{}entity"{}});}
\DoxyCodeLine{534             counter++;}
\DoxyCodeLine{535         \}}
\DoxyCodeLine{536         \textcolor{keywordflow}{return} counter;}
\DoxyCodeLine{537     \}}
\DoxyCodeLine{543     \textcolor{keywordtype}{void} \mbox{\hyperlink{classWorld_a3b8b43bcb554d3fffa54f1ac7a6892a9}{initWorld}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* path2story) \{}
\DoxyCodeLine{544         story.\mbox{\hyperlink{classtinyxml2_1_1XMLDocument_a2ebd4647a8af5fc6831b294ac26a150a}{LoadFile}}(path2story);}
\DoxyCodeLine{545         \mbox{\hyperlink{classtinyxml2_1_1XMLElement}{tinyxml2::XMLElement}}* worldElement = story.\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}world"{}});}
\DoxyCodeLine{546         \mbox{\hyperlink{classWorld_a7165c451a927399e060fa07a2e6b69d3}{loadRooms}}(worldElement-\/>\mbox{\hyperlink{classtinyxml2_1_1XMLNode_a1bec132dcf085284e0a10755f2cf0d57}{FirstChildElement}}(\textcolor{stringliteral}{"{}room"{}}));}
\DoxyCodeLine{547         \mbox{\hyperlink{classWorld_aebe04bd680604ecfdf2acbe61b828584}{connectRooms}}();}
\DoxyCodeLine{548     \}}
\DoxyCodeLine{553     \textcolor{keywordtype}{void} \mbox{\hyperlink{classWorld_ad4f23168ee864aa7919c2018c4615f77}{destroyWorld}}() \{}
\DoxyCodeLine{554         \textcolor{keywordflow}{for} (nodes::iterator it = worldRooms.begin(); it != worldRooms.end(); it++) \{}
\DoxyCodeLine{555             it-\/>reset();}
\DoxyCodeLine{556             std::cout << it-\/>use\_count() << std::endl;}
\DoxyCodeLine{557         \}}
\DoxyCodeLine{558         \textcolor{keywordflow}{for} (entities::iterator it = population.begin(); it != population.end(); it++) \{}
\DoxyCodeLine{559             it-\/>reset();}
\DoxyCodeLine{560         \}}
\DoxyCodeLine{561     \}}
\DoxyCodeLine{562     \textcolor{keyword}{virtual} \mbox{\hyperlink{classWorld}{\string~World}}() \{\}   }
\DoxyCodeLine{563 \};}
\DoxyCodeLine{564 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
