\hypertarget{gtest-message_8h_source}{}\doxysection{gtest-\/message.h}
\label{gtest-message_8h_source}\index{build/\_deps/googletest-\/src/googletest/include/gtest/gtest-\/message.h@{build/\_deps/googletest-\/src/googletest/include/gtest/gtest-\/message.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2005, Google Inc.}}
\DoxyCodeLine{2 \textcolor{comment}{// All rights reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{// Redistribution and use in source and binary forms, with or without}}
\DoxyCodeLine{5 \textcolor{comment}{// modification, are permitted provided that the following conditions are}}
\DoxyCodeLine{6 \textcolor{comment}{// met:}}
\DoxyCodeLine{7 \textcolor{comment}{//}}
\DoxyCodeLine{8 \textcolor{comment}{//     * Redistributions of source code must retain the above copyright}}
\DoxyCodeLine{9 \textcolor{comment}{// notice, this list of conditions and the following disclaimer.}}
\DoxyCodeLine{10 \textcolor{comment}{//     * Redistributions in binary form must reproduce the above}}
\DoxyCodeLine{11 \textcolor{comment}{// copyright notice, this list of conditions and the following disclaimer}}
\DoxyCodeLine{12 \textcolor{comment}{// in the documentation and/or other materials provided with the}}
\DoxyCodeLine{13 \textcolor{comment}{// distribution.}}
\DoxyCodeLine{14 \textcolor{comment}{//     * Neither the name of Google Inc. nor the names of its}}
\DoxyCodeLine{15 \textcolor{comment}{// contributors may be used to endorse or promote products derived from}}
\DoxyCodeLine{16 \textcolor{comment}{// this software without specific prior written permission.}}
\DoxyCodeLine{17 \textcolor{comment}{//}}
\DoxyCodeLine{18 \textcolor{comment}{// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS}}
\DoxyCodeLine{19 \textcolor{comment}{// "{}AS IS"{} AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT}}
\DoxyCodeLine{20 \textcolor{comment}{// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR}}
\DoxyCodeLine{21 \textcolor{comment}{// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT}}
\DoxyCodeLine{22 \textcolor{comment}{// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,}}
\DoxyCodeLine{23 \textcolor{comment}{// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT}}
\DoxyCodeLine{24 \textcolor{comment}{// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,}}
\DoxyCodeLine{25 \textcolor{comment}{// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY}}
\DoxyCodeLine{26 \textcolor{comment}{// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT}}
\DoxyCodeLine{27 \textcolor{comment}{// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE}}
\DoxyCodeLine{28 \textcolor{comment}{// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{comment}{// The Google C++ Testing and Mocking Framework (Google Test)}}
\DoxyCodeLine{31 \textcolor{comment}{//}}
\DoxyCodeLine{32 \textcolor{comment}{// This header file defines the Message class.}}
\DoxyCodeLine{33 \textcolor{comment}{//}}
\DoxyCodeLine{34 \textcolor{comment}{// IMPORTANT NOTE: Due to limitation of the C++ language, we have to}}
\DoxyCodeLine{35 \textcolor{comment}{// leave some internal implementation details in this header file.}}
\DoxyCodeLine{36 \textcolor{comment}{// They are clearly marked by comments like this:}}
\DoxyCodeLine{37 \textcolor{comment}{//}}
\DoxyCodeLine{38 \textcolor{comment}{//   // INTERNAL IMPLEMENTATION -\/ DO NOT USE IN A USER PROGRAM.}}
\DoxyCodeLine{39 \textcolor{comment}{//}}
\DoxyCodeLine{40 \textcolor{comment}{// Such code is NOT meant to be used by a user directly, and is subject}}
\DoxyCodeLine{41 \textcolor{comment}{// to CHANGE WITHOUT NOTICE.  Therefore DO NOT DEPEND ON IT in a user}}
\DoxyCodeLine{42 \textcolor{comment}{// program!}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{comment}{// IWYU pragma: private, include "{}gtest/gtest.h"{}}}
\DoxyCodeLine{45 \textcolor{comment}{// IWYU pragma: friend gtest/.*}}
\DoxyCodeLine{46 \textcolor{comment}{// IWYU pragma: friend gmock/.*}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{preprocessor}{\#ifndef GOOGLETEST\_INCLUDE\_GTEST\_GTEST\_MESSAGE\_H\_}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#define GOOGLETEST\_INCLUDE\_GTEST\_GTEST\_MESSAGE\_H\_}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{preprocessor}{\#include <limits>}}
\DoxyCodeLine{52 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{53 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{preprocessor}{\#include "{}gtest/internal/gtest-\/port.h"{}}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 GTEST\_DISABLE\_MSC\_WARNINGS\_PUSH\_(4251 \(\backslash\)}
\DoxyCodeLine{58 \textcolor{comment}{/* class A needs to have dll-\/interface to be used by clients of class B */})}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{comment}{// Ensures that there is at least one operator<< in the global namespace.}}
\DoxyCodeLine{61 \textcolor{comment}{// See Message\& operator<<(...) below for why.}}
\DoxyCodeLine{62 void operator<<(const testing::internal::Secret\&, \textcolor{keywordtype}{int});}
\DoxyCodeLine{63 }
\DoxyCodeLine{64 namespace testing \{}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \textcolor{comment}{// The Message class works like an ostream repeater.}}
\DoxyCodeLine{67 \textcolor{comment}{//}}
\DoxyCodeLine{68 \textcolor{comment}{// Typical usage:}}
\DoxyCodeLine{69 \textcolor{comment}{//}}
\DoxyCodeLine{70 \textcolor{comment}{//   1. You stream a bunch of values to a Message object.}}
\DoxyCodeLine{71 \textcolor{comment}{//      It will remember the text in a stringstream.}}
\DoxyCodeLine{72 \textcolor{comment}{//   2. Then you stream the Message object to an ostream.}}
\DoxyCodeLine{73 \textcolor{comment}{//      This causes the text in the Message to be streamed}}
\DoxyCodeLine{74 \textcolor{comment}{//      to the ostream.}}
\DoxyCodeLine{75 \textcolor{comment}{//}}
\DoxyCodeLine{76 \textcolor{comment}{// For example;}}
\DoxyCodeLine{77 \textcolor{comment}{//}}
\DoxyCodeLine{78 \textcolor{comment}{//   testing::Message foo;}}
\DoxyCodeLine{79 \textcolor{comment}{//   foo << 1 << "{} != "{} << 2;}}
\DoxyCodeLine{80 \textcolor{comment}{//   std::cout << foo;}}
\DoxyCodeLine{81 \textcolor{comment}{//}}
\DoxyCodeLine{82 \textcolor{comment}{// will print "{}1 != 2"{}.}}
\DoxyCodeLine{83 \textcolor{comment}{//}}
\DoxyCodeLine{84 \textcolor{comment}{// Message is not intended to be inherited from.  In particular, its}}
\DoxyCodeLine{85 \textcolor{comment}{// destructor is not virtual.}}
\DoxyCodeLine{86 \textcolor{comment}{//}}
\DoxyCodeLine{87 \textcolor{comment}{// Note that stringstream behaves differently in gcc and in MSVC.  You}}
\DoxyCodeLine{88 \textcolor{comment}{// can stream a NULL char pointer to it in the former, but not in the}}
\DoxyCodeLine{89 \textcolor{comment}{// latter (it causes an access violation if you do).  The Message}}
\DoxyCodeLine{90 \textcolor{comment}{// class hides this difference by treating a NULL char pointer as}}
\DoxyCodeLine{91 \textcolor{comment}{// "{}(null)"{}.}}
\DoxyCodeLine{92 \textcolor{keyword}{class }GTEST\_API\_ \mbox{\hyperlink{classtesting_1_1Message}{Message}} \{}
\DoxyCodeLine{93  \textcolor{keyword}{private}:}
\DoxyCodeLine{94   \textcolor{comment}{// The type of basic IO manipulators (endl, ends, and flush) for}}
\DoxyCodeLine{95   \textcolor{comment}{// narrow streams.}}
\DoxyCodeLine{96   \textcolor{keyword}{typedef} std::ostream\& (*BasicNarrowIoManip)(std::ostream\&);}
\DoxyCodeLine{97 }
\DoxyCodeLine{98  \textcolor{keyword}{public}:}
\DoxyCodeLine{99   \textcolor{comment}{// Constructs an empty Message.}}
\DoxyCodeLine{100   \mbox{\hyperlink{classtesting_1_1Message}{Message}}();}
\DoxyCodeLine{101 }
\DoxyCodeLine{102   \textcolor{comment}{// Copy constructor.}}
\DoxyCodeLine{103   \mbox{\hyperlink{classtesting_1_1Message}{Message}}(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Message}{Message}}\& msg) : ss\_(new ::std::stringstream) \{  \textcolor{comment}{// NOLINT}}
\DoxyCodeLine{104     *ss\_ << msg.GetString();}
\DoxyCodeLine{105   \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107   \textcolor{comment}{// Constructs a Message from a C-\/string.}}
\DoxyCodeLine{108   \textcolor{keyword}{explicit} \mbox{\hyperlink{classtesting_1_1Message}{Message}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* str) : ss\_(new ::std::stringstream) \{}
\DoxyCodeLine{109     *ss\_ << str;}
\DoxyCodeLine{110   \}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112   \textcolor{comment}{// Streams a non-\/pointer value to this object.}}
\DoxyCodeLine{113   \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{114   \textcolor{keyword}{inline} \mbox{\hyperlink{classtesting_1_1Message}{Message}}\& operator<<(\textcolor{keyword}{const} T\& val) \{}
\DoxyCodeLine{115         \textcolor{comment}{// Some libraries overload << for STL containers.  These}}
\DoxyCodeLine{116     \textcolor{comment}{// overloads are defined in the global namespace instead of ::std.}}
\DoxyCodeLine{117     \textcolor{comment}{//}}
\DoxyCodeLine{118     \textcolor{comment}{// C++'s symbol lookup rule (i.e. Koenig lookup) says that these}}
\DoxyCodeLine{119     \textcolor{comment}{// overloads are visible in either the std namespace or the global}}
\DoxyCodeLine{120     \textcolor{comment}{// namespace, but not other namespaces, including the testing}}
\DoxyCodeLine{121     \textcolor{comment}{// namespace which Google Test's Message class is in.}}
\DoxyCodeLine{122     \textcolor{comment}{//}}
\DoxyCodeLine{123     \textcolor{comment}{// To allow STL containers (and other types that has a << operator}}
\DoxyCodeLine{124     \textcolor{comment}{// defined in the global namespace) to be used in Google Test}}
\DoxyCodeLine{125     \textcolor{comment}{// assertions, testing::Message must access the custom << operator}}
\DoxyCodeLine{126     \textcolor{comment}{// from the global namespace.  With this using declaration,}}
\DoxyCodeLine{127     \textcolor{comment}{// overloads of << defined in the global namespace and those}}
\DoxyCodeLine{128     \textcolor{comment}{// visible via Koenig lookup are both exposed in this function.}}
\DoxyCodeLine{129     using ::operator<<;}
\DoxyCodeLine{130     *ss\_ << val;}
\DoxyCodeLine{131     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{132   \}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134   \textcolor{comment}{// Streams a pointer value to this object.}}
\DoxyCodeLine{135   \textcolor{comment}{//}}
\DoxyCodeLine{136   \textcolor{comment}{// This function is an overload of the previous one.  When you}}
\DoxyCodeLine{137   \textcolor{comment}{// stream a pointer to a Message, this definition will be used as it}}
\DoxyCodeLine{138   \textcolor{comment}{// is more specialized.  (The C++ Standard, section}}
\DoxyCodeLine{139   \textcolor{comment}{// [temp.func.order].)  If you stream a non-\/pointer, then the}}
\DoxyCodeLine{140   \textcolor{comment}{// previous definition will be used.}}
\DoxyCodeLine{141   \textcolor{comment}{//}}
\DoxyCodeLine{142   \textcolor{comment}{// The reason for this overload is that streaming a NULL pointer to}}
\DoxyCodeLine{143   \textcolor{comment}{// ostream is undefined behavior.  Depending on the compiler, you}}
\DoxyCodeLine{144   \textcolor{comment}{// may get "{}0"{}, "{}(nil)"{}, "{}(null)"{}, or an access violation.  To}}
\DoxyCodeLine{145   \textcolor{comment}{// ensure consistent result across compilers, we always treat NULL}}
\DoxyCodeLine{146   \textcolor{comment}{// as "{}(null)"{}.}}
\DoxyCodeLine{147   \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{148   \textcolor{keyword}{inline} \mbox{\hyperlink{classtesting_1_1Message}{Message}}\& operator<<(T* \textcolor{keyword}{const}\& pointer) \{  \textcolor{comment}{// NOLINT}}
\DoxyCodeLine{149     \textcolor{keywordflow}{if} (pointer == \textcolor{keyword}{nullptr}) \{}
\DoxyCodeLine{150       *ss\_ << \textcolor{stringliteral}{"{}(null)"{}};}
\DoxyCodeLine{151     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{152       *ss\_ << pointer;}
\DoxyCodeLine{153     \}}
\DoxyCodeLine{154     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{155   \}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157   \textcolor{comment}{// Since the basic IO manipulators are overloaded for both narrow}}
\DoxyCodeLine{158   \textcolor{comment}{// and wide streams, we have to provide this specialized definition}}
\DoxyCodeLine{159   \textcolor{comment}{// of operator <<, even though its body is the same as the}}
\DoxyCodeLine{160   \textcolor{comment}{// templatized version above.  Without this definition, streaming}}
\DoxyCodeLine{161   \textcolor{comment}{// endl or other basic IO manipulators to Message will confuse the}}
\DoxyCodeLine{162   \textcolor{comment}{// compiler.}}
\DoxyCodeLine{163   \mbox{\hyperlink{classtesting_1_1Message}{Message}}\& operator<<(BasicNarrowIoManip val) \{}
\DoxyCodeLine{164     *ss\_ << val;}
\DoxyCodeLine{165     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{166   \}}
\DoxyCodeLine{167 }
\DoxyCodeLine{168   \textcolor{comment}{// Instead of 1/0, we want to see true/false for bool values.}}
\DoxyCodeLine{169   \mbox{\hyperlink{classtesting_1_1Message}{Message}}\& operator<<(\textcolor{keywordtype}{bool} b) \{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} << (b ? \textcolor{stringliteral}{"{}true"{}} : \textcolor{stringliteral}{"{}false"{}}); \}}
\DoxyCodeLine{170 }
\DoxyCodeLine{171   \textcolor{comment}{// These two overloads allow streaming a wide C string to a Message}}
\DoxyCodeLine{172   \textcolor{comment}{// using the UTF-\/8 encoding.}}
\DoxyCodeLine{173   \mbox{\hyperlink{classtesting_1_1Message}{Message}}\& operator<<(\textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t}* wide\_c\_str);}
\DoxyCodeLine{174   \mbox{\hyperlink{classtesting_1_1Message}{Message}}\& operator<<(\textcolor{keywordtype}{wchar\_t}* wide\_c\_str);}
\DoxyCodeLine{175 }
\DoxyCodeLine{176 \textcolor{preprocessor}{\#if GTEST\_HAS\_STD\_WSTRING}}
\DoxyCodeLine{177   \textcolor{comment}{// Converts the given wide string to a narrow string using the UTF-\/8}}
\DoxyCodeLine{178   \textcolor{comment}{// encoding, and streams the result to this Message object.}}
\DoxyCodeLine{179   \mbox{\hyperlink{classtesting_1_1Message}{Message}}\& operator<<(const ::std::wstring\& wstr);}
\DoxyCodeLine{180 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// GTEST\_HAS\_STD\_WSTRING}}
\DoxyCodeLine{181 }
\DoxyCodeLine{182   \textcolor{comment}{// Gets the text streamed to this object so far as an std::string.}}
\DoxyCodeLine{183   \textcolor{comment}{// Each '\(\backslash\)0' character in the buffer is replaced with "{}\(\backslash\)\(\backslash\)0"{}.}}
\DoxyCodeLine{184   \textcolor{comment}{//}}
\DoxyCodeLine{185   \textcolor{comment}{// INTERNAL IMPLEMENTATION -\/ DO NOT USE IN A USER PROGRAM.}}
\DoxyCodeLine{186   std::string GetString() \textcolor{keyword}{const};}
\DoxyCodeLine{187 }
\DoxyCodeLine{188  \textcolor{keyword}{private}:}
\DoxyCodeLine{189   \textcolor{comment}{// We'll hold the text streamed to this object here.}}
\DoxyCodeLine{190   \textcolor{keyword}{const} std::unique\_ptr< ::std::stringstream> ss\_;}
\DoxyCodeLine{191 }
\DoxyCodeLine{192   \textcolor{comment}{// We declare (but don't implement) this to prevent the compiler}}
\DoxyCodeLine{193   \textcolor{comment}{// from implementing the assignment operator.}}
\DoxyCodeLine{194   \textcolor{keywordtype}{void} operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Message}{Message}}\&);}
\DoxyCodeLine{195 \};}
\DoxyCodeLine{196 }
\DoxyCodeLine{197 \textcolor{comment}{// Streams a Message to an ostream.}}
\DoxyCodeLine{198 \textcolor{keyword}{inline} std::ostream\& operator<<(std::ostream\& os, \textcolor{keyword}{const} \mbox{\hyperlink{classtesting_1_1Message}{Message}}\& sb) \{}
\DoxyCodeLine{199   \textcolor{keywordflow}{return} os << sb.GetString();}
\DoxyCodeLine{200 \}}
\DoxyCodeLine{201 }
\DoxyCodeLine{202 \textcolor{keyword}{namespace }internal \{}
\DoxyCodeLine{203 }
\DoxyCodeLine{204 \textcolor{comment}{// Converts a streamable value to an std::string.  A NULL pointer is}}
\DoxyCodeLine{205 \textcolor{comment}{// converted to "{}(null)"{}.  When the input value is a ::string,}}
\DoxyCodeLine{206 \textcolor{comment}{// ::std::string, ::wstring, or ::std::wstring object, each NUL}}
\DoxyCodeLine{207 \textcolor{comment}{// character in it is replaced with "{}\(\backslash\)\(\backslash\)0"{}.}}
\DoxyCodeLine{208 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{209 std::string StreamableToString(\textcolor{keyword}{const} T\& streamable) \{}
\DoxyCodeLine{210   \textcolor{keywordflow}{return} (Message() << streamable).GetString();}
\DoxyCodeLine{211 \}}
\DoxyCodeLine{212 }
\DoxyCodeLine{213 \}  \textcolor{comment}{// namespace internal}}
\DoxyCodeLine{214 \}  \textcolor{comment}{// namespace testing}}
\DoxyCodeLine{215 }
\DoxyCodeLine{216 GTEST\_DISABLE\_MSC\_WARNINGS\_POP\_()  \textcolor{comment}{//  4251}}
\DoxyCodeLine{217 }
\DoxyCodeLine{218 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// GOOGLETEST\_INCLUDE\_GTEST\_GTEST\_MESSAGE\_H\_}}

\end{DoxyCode}
